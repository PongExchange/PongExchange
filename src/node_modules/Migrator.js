"use strict";

require('co')(function*()
{
	console.log('Migrator.js called');
	
	var Config = require('Config');
	yield Config.initialize();
	
	var Path = require('path');
	var PgMayflower = require('pg.mayflower');
	
	// run SQL migrations
	var migrator = new PgMayflower({
		directory: Path.resolve(__dirname, '../../migrations'),
		connectionString: Config.sql.testingConnection
	});
	console.log('Migrating ' + Config.sql.testingConnection);
	yield migrator.migrateAll();
})();
